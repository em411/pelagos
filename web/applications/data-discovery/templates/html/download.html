<script type="text/javascript">
    var $ = jQuery.noConflict();

    var start = 0;
    var end = 0;

    function TestDownload() {
        start = new Date().getTime();
        $.ajax({
            type: "GET",
            url: "/download/testfile.bin?id=" + start,
            success: function(msg) {
                end = new Date().getTime();
                diff = (end - start) / 1000;
                bytes = msg.length;
                speed = (bytes / diff);
                time = {{bytes}} / speed;
                unit = "second";
                if (time > 60) {
                    time = time / 60;
                    unit = "minute";
                }
                if (time > 60) {
                    time = time / 60;
                    unit = "hour";
                }
                if (Math.round(time) != 1) unit += "s";
                $('#dl_time').html(Math.round(time) + " " + unit + " (based on your current connection speed)");
            }
        });
    }

    $(document).ready(function() {
        TestDownload();
    });

</script>

<div id="dataset_download_content">

<h3 style="text-align:center;">The dataset you selected is ready for download.</h3>

<div style="border: 1px solid #aaa; padding: 10px; border-radius: 4px;">
    <p style="margin-top:0"><strong>UDI:</strong> {{dataset.udi}}</p>

    <p><strong>Title:</strong> {{dataset.title}}</p>

    <p><strong>Originator:</strong> {{dataset.dataset_originator}}</p>

    {% if dataset.metadata_filename %}
        <p><strong>Metadata:</strong> <a href="/metadata/{{dataset.udi}}">{{dataset.metadata_filename}}</a></p>
    {% endif %}

    <p><strong>Filename:</strong> {{dataset.dataset_filename}}</p>

    <p><strong>Size:</strong> {{filesize}}</p>

    <p><strong>Estimated Download Time:</strong> <span id="dl_time">calculating...</span></p>
    <p style="margin-bottom:0"><strong>GridFTP: </strong>This file has been made available on the gomri#griidc endpoint.  Non-GoMRI users, including general public users, please <a href="mailto:griidc@gomri.org">contact us</a> for access.  If you need to establish GridFTP endpoint, please visit <a href="http://globus.org" target="new">Globus.org</a>.</p>
</div>

<div style="border: 1px solid #aaa; padding: 10px; margin-top: 20px; border-radius: 4px;">
    <p style="margin-top:0">
        <strong>DISCLAIMER:</strong> Gulf of Mexico Research Initiative Information and Data Cooperative (GRIIDC) aggregates data from researchers funded by the Gulf of Mexico Initiative and other scientists working in the region. These data are furnished "as is" for the convenience of all data users. GRIIDC makes no warranties (including no warranties as to merchantability, timeliness or fitness) either expressed or implied with respect to the data or their fitness for any specific application.
    </p>
    <div style="text-align:left;">
        <p>
            By downloading data you are expressing agreement with the disclaimer.
        </p>
           <div>
            <button onclick="location.href='http://{{server}}/download/{{uid}}/{{dataset.dataset_filename}}';jQuery('#dataset_download').hide();" style="padding: 0px 0px;"><img src={{baseUrl}}/includes/images/select-arrow.png></button> Download File directy via web <br />
                <button onclick="location.href='{{baseUrl}}/enableGridFTP/{{dataset.udi}}' ;jQuery('#dataset_download').hide();" style="padding: 0px 0px;"><img src={{baseUrl}}/includes/images/select-arrow.png></button> Place file on "gomri#griidc" GridFTP endpoint.  (Ideal for very large files) <br />
            <button onclick="jQuery('#dataset_download').hide();" style="padding: 0px 0px;"><img src={{baseUrl}}/includes/images/select-arrow.png border=0></button> Cancel Download<br />
        </div>
    </div>
</div>

</div>
