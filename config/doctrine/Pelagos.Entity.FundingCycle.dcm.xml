<!--
This file defines the Doctrine mapping between the Pelagos\Entity\FundingCycle
entity class and the funding_cycle view in the postgres database.
Properties other than id that are inherited from Pelagos\Entity\Entity are mapped in
Pelagos.Entity.Entity.dcm.xml
-->

<doctrine-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mapping
                        http://raw.github.com/doctrine/doctrine2/master/doctrine-mapping.xsd">

    <entity name="Pelagos\Entity\FundingCycle" table="funding_cycle">

        <id name="id" column="funding_cycle_number" type="integer">
            <generator strategy="SEQUENCE" />
            <sequence-generator sequence-name="seq_funding_cycle_number" allocation-size="1" initial-value="1" />
        </id>

        <field name="name"        column="name"        type="string" />

        <field name="description" column="description" type="string" />

        <field name="url"         column="website"     type="string" />

        <field name="startDate"   column="start_date"  type="date" />

        <field name="endDate"     column="end_date"    type="date" />

        <many-to-one field="fundingOrganization" target-entity="FundingOrganization">
            <join-column name="funding_organization_number" referenced-column-name="funding_organization_number" />
        </many-to-one>

        <one-to-many field="researchGroups" target-entity="ResearchGroup" mapped-by="fundingCycle" />

    </entity>

</doctrine-mapping>
